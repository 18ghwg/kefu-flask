# 系统监控功能安装说明

## 功能说明

在管理员后台底部添加了实时系统监控显示，包括：

1. **程序内存占用** - 显示当前Flask应用占用的内存大小
2. **系统内存** - 显示服务器总内存使用百分比
3. **CPU使用率** - 显示CPU使用百分比和核心数
4. **数据库连接** - 显示当前数据库连接数/最大连接数

所有指标都带有实时更新的进度条，颜色会根据使用率变化：
- 绿色（正常）：< 70%
- 黄色（警告）：70% - 90%
- 红色（危险）：> 90%

## 安装步骤

### 1. 安装依赖

```bash
pip install psutil==5.9.8
```

或者使用requirements.txt安装所有依赖：

```bash
pip install -r requirements.txt
```

### 2. 重启应用

```bash
# Windows
restart_app.bat

# Linux/Mac
./restart_app.sh
```

## 技术实现

### 后端API

新增API端点：`/admin/system-monitor`

- 使用 `psutil` 库获取系统信息
- 查询MySQL数据库连接状态
- 每3秒自动更新一次

### 前端显示

- 位置：管理后台底部栏中央
- 更新频率：3秒
- 响应式设计：移动端自动隐藏进度条

### 文件修改

1. `templates/includes/footer.html` - 添加监控UI和JavaScript
2. `mod/blueprint/admin.py` - 添加系统监控API
3. `static/css/admin/base.css` - 调整底部栏高度
4. `requirements.txt` - 添加psutil依赖

## 使用说明

登录管理员后台后，在页面底部即可看到实时系统监控信息。

将鼠标悬停在各个监控项上可以看到详细说明。

## 注意事项

1. 需要管理员权限才能访问监控API
2. 数据库连接数需要MySQL数据库支持
3. 建议在生产环境中适当调整更新频率以减少服务器负载

## 故障排除

### 监控数据显示为 "--"

- 检查是否已安装psutil库
- 检查后端API是否正常响应
- 查看浏览器控制台是否有错误信息

### 数据库连接数显示为 0/0

- 检查数据库连接是否正常
- 确认MySQL用户有查询系统变量的权限

## 性能影响

- CPU占用：< 0.1%
- 内存占用：< 5MB
- 网络流量：每次请求约 200 bytes
- 更新频率：3秒/次

对系统性能影响极小，可以放心使用。
