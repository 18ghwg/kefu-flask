<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <title>安全验证 - 客服系统</title>
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/vendor/font-awesome/all.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/common/csrf_verify.css') }}">
</head>
<body>
    <div class="verify-container">
        <div class="verify-icon">
            <i class="fas fa-shield-alt"></i>
        </div>

        <h1 class="verify-title">🔐 安全验证</h1>
        <p class="verify-description">
            检测到您的请求缺少安全验证令牌（CSRF Token），为了保护您的账户安全，请重新验证身份。
        </p>

        <div class="error-info">
            <h4>
                <i class="fas fa-exclamation-triangle"></i>
                可能的原因
            </h4>
            <ul>
                <li>会话已过期，请重新登录</li>
                <li>浏览器Cookie被清除</li>
                <li>页面打开时间过长，安全令牌已失效</li>
                <li>跨站请求伪造（CSRF）攻击被拦截</li>
            </ul>
        </div>

        <div class="verify-buttons">
            <button class="btn btn-primary" onclick="refreshPage()">
                <i class="fas fa-sync-alt"></i>
                重新加载页面
            </button>
            <button class="btn btn-secondary" onclick="goBack()">
                <i class="fas fa-arrow-left"></i>
                返回上一页
            </button>
        </div>

        <div class="security-tips">
            <h4>
                <i class="fas fa-info-circle"></i>
                安全提示
            </h4>
            <ul>
                <li>不要在公共网络下访问敏感信息</li>
                <li>定期清理浏览器缓存和Cookie</li>
                <li>不要点击来历不明的链接</li>
                <li>如果问题持续出现，请联系系统管理员</li>
            </ul>
        </div>

        <p style="margin-top: 20px; font-size: 14px; color: #9ca3af;">
            <span class="countdown" id="countdown">5</span> 秒后自动刷新页面...
        </p>
    </div>

    <script src="{{ url_for('static', filename='js/theme-manager.js') }}"></script>
    <script src="{{ url_for('static', filename='js/common/csrf_verify.js') }}"></script>
</body>
</html>

